# Services

Standard: **Refactor Angular applications to use services and components (<a href="#">W0046</a>)**

## Objectives

* Describe and Compare Services Angular.js
* Describe a Singleton and enumerate use cases for Singletons
* Create a custom Service to use in an Angular app
* Use an Angular Service to manage data across components

## A brief introduction

As you start building larger applications with multiple components, not only is your code per component becoming larger, but you are starting to face a new problem. How do you share data, properties and methods between components?

You use services!

Angular services are like instances of classes that are added to your code via dependency injection.  From the[ angular docs](https://docs.angularjs.org/guide/services):

> Angular services are:
>
> * Lazily instantiated – Angular only instantiates a service when an application component depends on it.
> * Singletons – Each component dependent on a service gets a reference to the single instance generated by the service factory.

That first bullet point may be a bit easier to digest (no pun intended), but what is a singleton? From Wikipedia "In software engineering, the singleton pattern is a design pattern that restricts the instantiation of a class to one object." You can read some more about it [here](http://addyosmani.com/resources/essentialjsdesignpatterns/book/#singletonpatternjavascript), [here](http://robdodson.me/javascript-design-patterns-singleton/) and [here](https://en.wikipedia.org/wiki/Singleton_pattern).

Using the service API, you create a constructor function using the `this` syntax to attach properties/methods to the constructor.

Here is a service defined using the service API:

```js
angular
  .module("learnServices", [])
  .service('personService', function(){
    this.name = "Matt";
    this.job = "Instructor";
    this.sayHi = function(){
      return "Hello!"
    }
  })
```

### Creating your first Service

The syntax to create a service looks like this:

```js
angular
  .module("app")
  .service("firstService", function() {
    this.sayHi = function() {
      return "Hello!"
    }

    this.sayGoodbye = function() {
      return "Goodbye!"
    }

    this.getAllUsers = function() {
      // some AJAX call to our database to get all the users
    }

    this.addUser = function(user) {
      // another AJAX call to our database to add a user
    }
  });
```

Now in your component's controller, you can inject this service:

```js
(function() {
  'use strict';

  angular
    .module("app")
    .component("myComponent", {
      controller: controller
    })

    controller.$inject = ['firstService']
    function controller(firstService) {
      const vm = this

      vm.view = {}
      vm.view.greeting = firstService.sayHi()
      vm.view.users = firstService.getAllUsers()
    }

}())
```

## Services and async events

Use the following guide:

- Make all `$http` calls in your service
- Return promises from the service methods
- Bind to the resolved value of the promises

# Resources

[Putting Angular Code in the Right Place](http://datamelon.io/blog/2016/putting-angular-code-in-the-right-place.html)
